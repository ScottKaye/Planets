!function(t){"use strict";function c(t){clearInterval(s);var e=t.pageX,a=t.pageY;$(l).stop().animate({top:a,left:e,opacity:1},i),l.innerHTML=d(this.planet)}function h(){$(l).stop().animate({opacity:0},i),s=window.setInterval(w,i)}function d(t){var e=$("<div></div>").append($("<h1></h1>").text(t.name)),i=$("<div></div>").addClass("planet-table-container"),a=$("<table></table>");return a.append(p("Day",t.day.natural+" <small>Earth hours</small>")),a.append(p("Year",t.length_of_year.natural+" <small>Earth years</small>")),a.append(p("Mass",t.mass.natural+" <small>times that of Earth</small>")),a.append(p("Distance",t.distance.natural+" <small>million km</small>")),a.append(p("Radius","~"+t.radius.natural+" <small>km</small>")),i.append(a),t.satellites?(i.append("<h2>Satellites</h2>"),t.satellites.forEach(function(t){i.append(v(t))})):i.append("<table><tr><td>No satellites.</td></tr></table>"),e.append(i),e.html()}function p(t,e){return $("<tr></tr>").append($("<td></td>").text(t)).append($("<td></td>").html(e))}function v(t){return console.log(t),$("<div></div>").append($("<h3></h3>").text(t.name)).append($("<table></table>").append(p("Orbit distance",t.distance_from_planet.natural+" <small>km</small>")).append(p("Orbit time",t.orbit.natural+" <small>Earth days</small>")))}function u(){this.animate({opacity:.3},i)}function g(){this.animate({opacity:.2},i)}function f(t){o=new Raphael(t,a,r);var e,i,s;e=o.width,i=o.height,s=o.setViewBox(0,0,o.width,o.height),s.X=0,s.Y=0,t.addEventListener("wheel",function(t){console.log(t);var a=t.wheelDelta/120;if(n+=a,-10>n||n>10)return void(n-=a);var r=e,l=i,c=a>0?.9:1.1;e*=c,i*=c,s.X-=(e-r)/2,s.Y-=(i-l)/2,o.setViewBox(s.X,s.Y,e,i)}),l=document.createElement("div"),l.id="tooltip",document.body.appendChild(l)}function w(){for(var e=t.planets.length;e--;){var a=t.planets[e];a.orbit.progress+=a.orbit_time_step;var r=a.orbit.length/(100/a.orbit.progress);r>=a.orbit.length&&(a.orbit.progress=0);var n=a.orbit.getPointAtLength(r);if(a.set.animate({cx:n.x,cy:n.y},i),a.satellites)for(var o=a.satellites.length;o--;){var l=a.satellites[o];l.physicalOrbit.progress+=2;var s=l.physicalOrbit.length/(100/l.physicalOrbit.progress);s>=l.physicalOrbit.length&&(l.physicalOrbit.progress=0);var c=l.physicalOrbit.getPointAtLength(s);l.circle.animate({cx:c.x,cy:c.y},i),l.physicalOrbit.animate({cx:n.x,cy:n.y},i)}}}function b(){var e=25;o.circle(a/2,r/2,e).attr({fill:"#ff9900","stroke-width":0}).noclick().glow({color:"#ff9900",width:50});var n,l,d={distance:0,radius:0};for(l=t.planets.length;l--;)n=t.planets[l],n.distance>d.distance&&(d.distance=n.distance),n.radius>d.radius&&(d.radius=n.radius);for(l=t.planets.length;l--;){n=t.planets[l];var p=n.radius/d.radius*r/50+2;p=n.radius/5e3;var v=n.distance/10+1.5*e;n.orbit=o.ellipse(a/2,r/2,v,v).attr({fill:"#5a4479","stroke-width":0,opacity:.2}).hover(u,g),n.orbit.length=n.orbit.getTotalLength();var f=n.orbit.length*l/t.planets.length,b=n.orbit.getPointAtLength(f),m=Math.max(1.2*p,10),y=o.circle(b.x,b.y,m).attr({fill:n.color,"stroke-width":0,opacity:.2});if(n.circle=o.circle(b.x,b.y,p).attr({fill:n.color,"stroke-width":0}).toFront().noclick(),y.hover(c,h,n.circle),n.orbit.progress=f,n.orbit.toBack(),n.circle.planet=n,n.set=o.set(),n.satellites)for(var x=n.satellites.length;x--;){var k=n.satellites[x],L=p*k.distance_from_planet/1e5;L=Math.max(L,5*p),L=Math.min(L,2.5*p),k.physicalOrbit=o.circle(b.x,b.y,L).attr({opacity:.05,stroke:"#000","stroke-width":1}).noclick(),k.physicalOrbit.length=k.physicalOrbit.getTotalLength();var $=k.physicalOrbit.length*Math.random(),_=k.physicalOrbit.getPointAtLength($);k.physicalOrbit.progress=$,k.circle=o.circle(_.x,_.y,.25*p).attr({"stroke-width":0,fill:"#777"}).noclick()}n.set.push(n.circle),n.set.push(y)}s=window.setInterval(w,i)}var i=400,a=window.innerWidth,r=window.innerHeight,n=0,o=null,l=null,s=null;Raphael.el.noclick=function(){return this.node.setAttribute("pointer-events","none"),this},t.loadGui=function(e){console.log(e),t.status.loaded&&(f(e),b())},t.planetTable=function(t){return d(t)}}(window.solar=window.solar||{});