!function(t){"use strict";function c(t){clearInterval(s);var e=t.pageX,i=t.pageY;$(o).stop().animate({top:i,left:e,opacity:1},a),o.innerHTML=d(this.planet)}function h(){$(o).stop().animate({opacity:0},a),s=window.setInterval(b,a)}function d(t){var e=$("<div></div>").append($("<h1></h1>").text(t.name)),a=$("<div></div>").addClass("planet-table-container"),i=$("<table></table>");return i.append(p("Day",t.day.natural+" <small>Earth hours</small>")),i.append(p("Year",t.length_of_year.natural+" <small>Earth years</small>")),i.append(p("Mass",t.mass.natural+" <small>times that of Earth</small>")),i.append(p("Distance",t.distance.natural+" <small>million km</small>")),i.append(p("Radius","~"+t.radius.natural+" <small>km</small>")),a.append(i),t.satellites?(a.append("<h2>Satellites</h2>"),t.satellites.forEach(function(t){a.append(v(t))})):a.append("<table><tr><td>No satellites.</td></tr></table>"),e.append(a),e.html()}function p(t,e){return $("<tr></tr>").append($("<td></td>").text(t)).append($("<td></td>").html(e))}function v(t){return $("<div></div>").append($("<h3></h3>").text(t.name)).append($("<table></table>").append(p("Orbit distance",t.distance_from_planet.natural+" <small>km</small>")).append(p("Orbit time",t.orbit.natural+" <small>Earth days</small>")))}function u(){this.animate({opacity:.3},a)}function g(){this.animate({opacity:.2},a)}function f(t){l=new Raphael(t,i,r);var e,a,s;e=l.width,a=l.height,s=l.setViewBox(0,0,l.width,l.height),s.X=0,s.Y=0,t.addEventListener("wheel",function(t){var i=t.wheelDelta/120;if(n+=i,-10>n||n>10)return void(n-=i);var r=e,o=a,c=i>0?.9:1.1;e*=c,a*=c,s.X-=(e-r)/2,s.Y-=(a-o)/2,l.setViewBox(s.X,s.Y,e,a)}),o=document.createElement("div"),o.id="tooltip",document.body.appendChild(o)}function b(){for(var e=t.planets.length;e--;){var i=t.planets[e];i.orbit.progress+=i.orbit_time_step;var r=i.orbit.length/(100/i.orbit.progress);r>=i.orbit.length&&(i.orbit.progress=0);var n=i.orbit.getPointAtLength(r);if(i.set.animate({cx:n.x,cy:n.y},a),i.satellites)for(var l=i.satellites.length;l--;){var o=i.satellites[l];o.physicalOrbit.progress+=2;var s=o.physicalOrbit.length/(100/o.physicalOrbit.progress);s>=o.physicalOrbit.length&&(o.physicalOrbit.progress=0);var c=o.physicalOrbit.getPointAtLength(s);o.circle.animate({cx:c.x,cy:c.y},a),o.physicalOrbit.animate({cx:n.x,cy:n.y},a)}}}function w(){var e=25;l.circle(i/2,r/2,e).attr({fill:"#ff9900","stroke-width":0}).noclick().glow({color:"#ff9900",width:50});for(var n,o=t.planets.length,d={distance:0,radius:0};o--;)n=t.planets[o],n.distance>d.distance&&(d.distance=n.distance),n.radius>d.radius&&(d.radius=n.radius);for(o=t.planets.length;o--;){n=t.planets[o];var p=n.radius/d.radius*r/50+2;p=n.radius/5e3;var v=n.distance/10+1.5*e;n.orbit=l.ellipse(i/2,r/2,v,v).attr({fill:"#5a4479","stroke-width":0,opacity:.2}).hover(u,g),n.orbit.length=n.orbit.getTotalLength();var f=n.orbit.length*o/t.planets.length,w=n.orbit.getPointAtLength(f),m=Math.max(1.2*p,10),y=l.circle(w.x,w.y,m).attr({fill:n.color,"stroke-width":0,opacity:.2});if(n.circle=l.circle(w.x,w.y,p).attr({fill:n.color,"stroke-width":0}).toFront().noclick(),y.hover(c,h,n.circle),n.orbit.progress=f,n.orbit.toBack(),n.circle.planet=n,n.set=l.set(),n.satellites)for(var x=n.satellites.length;x--;){var k=n.satellites[x],$=p*k.distance_from_planet/1e5;$=Math.max($,5*p),$=Math.min($,2.5*p),k.physicalOrbit=l.circle(w.x,w.y,$).attr({opacity:.05,stroke:"#000","stroke-width":1}).noclick(),k.physicalOrbit.length=k.physicalOrbit.getTotalLength();var L=k.physicalOrbit.length*Math.random(),_=k.physicalOrbit.getPointAtLength(L);k.physicalOrbit.progress=L,k.circle=l.circle(_.x,_.y,.25*p).attr({"stroke-width":0,fill:"#777"}).noclick()}n.set.push(n.circle),n.set.push(y)}s=window.setInterval(b,a)}var a=400,i=window.innerWidth,r=window.innerHeight,n=0,l=null,o=null,s=null;Raphael.el.noclick=function(){return this.node.setAttribute("pointer-events","none"),this},t.loadGui=function(e){t.status.loaded&&(f(e),w())},t.planetTable=function(t){return d(t)}}(window.solar=window.solar||{});